

<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/style.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <title>FICHIER TARIFS</title>
</head>

<body>
    <main id="fichier-tarifs">
        <div>
            <form id="priceForm">
                <div class="container">
                    <div class="left-container">

                        <img class="logo" src="../addons/img/Atys Car.jpg" alt="atyscar-logo">

                        <a href="../actualiser/"><input value="Retour" type="button" class="menu-button"></a>

                    </div>

                    <div class="right-container">
                        <div class="forfait">
                            <h1>Particulier</h1>
                            <h3>Vacances scolaires</h3>
                            <div class="box-l">
                                <div class="container-element">
                                    <label for="particulier-vacances-forfait">Forfait</label>
                                    <input id="particulier-vacances-forfait" type="number" name="particulier-vacances-forfait" value=''>
                                </div>
                                <div class="container-element">
                                    <label for="particulier-vacances-duree">Duree</label>
                                    <input id="particulier-vacances-duree" type="number" name="particulier-vacances-duree">
                                </div>
                                <div class="container-element">
                                    <label for="particulier-vacances-kilometrage">Kilometrage</label>
                                    <input id="particulier-vacances-kilometrage" type="number" name="particulier-vacances-kilometrage">
                                </div>
                            </div>
                            <h3>Eté</h3>
                            <div class="box-l">
                                <div class="container-element">
                                    <label for="particulier-ete-forfait">Forfait</label>
                                    <input id="particulier-ete-forfait" type="number" name="particulier-ete-forfait">
                                </div>
                                <div class="container-element">
                                    <label for="particulier-ete-duree">Duree</label>
                                    <input id="particulier-ete-duree" type="number" name="particulier-ete-duree">
                                </div>
                                <div class="container-element">
                                    <label for="particulier-ete-kilometrage">Kilometrage</label>
                                    <input id="particulier-ete-kilometrage" type="number" name="particulier-ete-kilometrage">
                                </div>
                            </div>
                            <h3>Hiver</h3>
                            <div class="box-l">
                                <div class="container-element">
                                    <label for="particulier-hiver-forfait">Forfait</label>
                                    <input id="particulier-hiver-forfait" type="number" name="particulier-hiver-forfait">
                                </div>
                                <div class="container-element">
                                    <label for="particulier-hiver-duree">Duree</label>
                                    <input id="particulier-hiver-duree" type="number" name="particulier-hiver-duree">
                                </div>
                                <div class="container-element">
                                    <label for="particulier-hiver-kilometrage">Kilometrage</label>
                                    <input id="particulier-hiver-kilometrage" type="number" name="particulier-hiver-kilometrage">
                                </div>
                            </div>

                        </div>

                        <div class="forfait">
                            <h1>Entreprise</h1>
                            <h3>Vacances scolaires</h3>
                            <div class="box-l">
                                <div class="container-element">
                                    <label for="entreprise-vacances-forfait">Forfait</label>
                                    <input id="entreprise-vacances-forfait" type="number" name="entreprise-vacances-forfait">
                                </div>
                                <div class="container-element">
                                    <label for="entreprise-vacances-duree">Duree</label>
                                    <input id="entreprise-vacances-duree" type="number" name="entreprise-vacances-duree">
                                </div>
                                <div class="container-element">
                                    <label for="entreprise-vacances-kilometrage">Kilometrage</label>
                                    <input id="entreprise-vacances-kilometrage" type="number" name="entreprise-vacances-kilometrage">
                                </div>
                            </div>
                            <h3>Eté</h3>
                            <div class="box-l">
                                <div class="container-element">
                                    <label for="entreprise-ete-forfait">Forfait</label>
                                    <input id="entreprise-ete-forfait" type="number" name="entreprise-ete-forfait">
                                </div>
                                <div class="container-element">
                                    <label for="entreprise-ete-duree">Duree</label>
                                    <input id="entreprise-ete-duree" type="number" name="entreprise-ete-duree">
                                </div>
                                <div class="container-element">
                                    <label for="entreprise-ete-kilometrage">Kilometrage</label>
                                    <input id="entreprise-ete-kilometrage" type="number" name="entreprise-ete-kilometrage">
                                </div>
                            </div>
                            <h3>Hiver</h3>
                            <div class="box-l">
                                <div class="container-element">
                                    <label for="entreprise-hiver-forfait">Forfait</label>
                                    <input id="entreprise-hiver-forfait" type="number" name="entreprise-hiver-forfait">
                                </div>
                                <div class="container-element">
                                    <label for="entreprise-hiver-duree">Duree</label>
                                    <input id="entreprise-hiver-duree" type="number" name="entreprise-hiver-duree">
                                </div>
                                <div class="container-element">
                                    <label for="entreprise-hiver-kilometrage">Kilometrage</label>
                                    <input id="entreprise-hiver-kilometrage" type="number" name="entreprise-hiver-kilometrage">
                                </div>
                            </div>

                        </div>

                        <div class="forfait">
                            <h1>Privilégié</h1>
                            <h3>Vacances scolaires</h3>
                            <div class="box-l">
                                <div class="container-element">
                                    <label for="privilegie-vacances-forfait">Forfait</label>
                                    <input id="privilegie-vacances-forfait" type="number" name="privilegie-vacances-forfait">
                                </div>
                                <div class="container-element">
                                    <label for="privilegie-vacances-duree">Duree</label>
                                    <input id="privilegie-vacances-duree" type="number" name="privilegie-vacances-duree">
                                </div>
                                <div class="container-element">
                                    <label for="privilegie-vacances-kilometrage">Kilometrage</label>
                                    <input id="privilegie-vacances-kilometrage" type="number" name="privilegie-vacances-kilometrage">
                                </div>
                            </div>
                            <h3>Eté</h3>
                            <div class="box-l">
                                <div class="container-element">
                                    <label for="privilegie-ete-forfait">Forfait</label>
                                    <input id="privilegie-ete-forfait" type="number" name="privilegie-ete-forfait">
                                </div>
                                <div class="container-element">
                                    <label for="privilegie-ete-duree">Duree</label>
                                    <input id="privilegie-ete-duree" type="number" name="privilegie-ete-duree">
                                </div>
                                <div class="container-element">
                                    <label for="privilegie-ete-kilometrage">Kilometrage</label>
                                    <input id="privilegie-ete-kilometrage" type="number" name="privilegie-ete-kilometrage">
                                </div>
                            </div>

                            <h3>Hiver</h3>
                            <div class="box-l">
                                <div class="container-element">
                                    <label for="privilegie-hiver-forfait">Forfait</label>
                                    <input id="privilegie-hiver-forfait" type="number" name="privilegie-hiver-forfait">
                                </div>
                                <div class="container-element">
                                    <label for="privilegie-hiver-duree">Duree</label>
                                    <input id="privilegie-hiver-duree" type="number" name="privilegie-hiver-duree">
                                </div>
                                <div class="container-element">
                                    <label for="privilegie-hiver-kilometrage">Kilometrage</label>
                                    <input id="privilegie-hiver-kilometrage" type="number" name="privilegie-hiver-kilometrage">
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </form>

        </div>
    </main>
</body>
<script>

    document.addEventListener("DOMContentLoaded", function() {
        // Récupère tous les inputs du document
        var inputs = document.querySelectorAll("input[type='number']");

        // Ajoute une écoute pour chaque element
        inputs.forEach(function(input) {
            
            // Ajout de l'évement "Si perte de focus sur input" 
            input.addEventListener("blur", function(event) { 
                // Recupère les données des cibles ayant déclancher l'évenement
                var inputName = event.target.name;
                var inputValue = event.target.value;
                
                $.ajax({
                    url: "../php/savePrice.php",
                    type: 'POST',
                    header: {
                        'Content-Type': 'json/application',
                    },
                    data: {
                        'tarifs': {
                            'name' : inputName,
                            'value' : inputValue,
                        }
                    },
                    success: function() {
                        //console.log('Prices have been saved.');
                    },
                    error: function(xhr, status, error) {
                        console.error('Error page in (fichier-tarifs.php)', status, error);
                    }


                });
            });
        });
    });




    
</script>
<?php 
$query = 'SELECT * FROM TARIFS';

$dbh = new PDO('mysql:host=localhost;dbname=wb-atyscar','root','');
$stmt = $dbh->prepare($query);
$stmt->execute();

// Fetch all rows as an array of associative arrays
$allRows = $stmt->fetchAll(PDO::FETCH_ASSOC);

// You can loop through the rows if needed
echo "<script>";
foreach ($allRows as $row) {
    // Access individual columns using the column name
    $name = '';
    switch ($row['CodTypC']) {
        case '1':
            $name .= 'particulier';
            break;
        case '2':
            $name .= 'entreprise';
            break;
        case '3':
            $name .= 'privilegie';
            break;
    }
    switch ($row['CodPerT']) {
        case 'VAC':
            $name .= '-vacances';
            break;
        case 'HIV':
            $name .= '-hiver';
            break;
        case 'ETE':
            $name .= '-ete';
            break;
    }
    switch ($row['CodTypTarif']) {
        case '1':
            $name .= '-forfait';
            break;
        case '2':
            $name .= '-duree';
            break;
        case '3':
            $name .= '-kilometrage';
            break;
    }

    echo "var element = document.getElementById('" . $name . "');";
    echo "    element.value = " . $row['tarif'] . ";";

        // Process data or output as needed
}
echo "</script>";
?>
</html>